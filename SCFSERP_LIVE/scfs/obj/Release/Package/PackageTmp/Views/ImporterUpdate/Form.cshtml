@using scfs_erp.Models;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@{
    ViewBag.Title = "Importer Name Update";
}

<div id="main-content">
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-12">
                <div class="box">
                    <div class="box-header">
                        <div class="box-name">
                            <i class="glyphicon glyphicon-import"></i>
                            <strong>Importer Name Update</strong>
                        </div>
                    </div>@Html.Raw(ViewBag.msg)
                    <div class="box-content" data-ng-app="myModule">
                        <form action="@Url.Content("~/ImporterUpdate/savedata")" method="post" accept-charset="utf-8" id="frm" data-ng-controller="myController" name="frm" onsubmit="return Validate()">
                            @Html.ValidationSummary(true)
                            <fieldset id="ExportCartingOrder_info">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="col-md-3">

                                            <div class="form-group">
                                                <label>IGM No </label>@*@Html.ValidationMessageFor(model => model.masterdata[0].OSMIGMNO)*@
                                                <input type="text" class="OSMIGMNO form-control" name="OSMIGMNO" id="OSMIGMNO" placeholder="--Enter no-" tabindex="6" />
                                                @*@Html.TextBox("OSMIGMNO", new { @class = "form-control  OSMIGMNO", @id = "OSMIGMNO", @placeholder = "---Please Type IGMNO----", tabindex = "48", @required = "required" })*@

                                            </div>
                                        </div>
                                        <div class="col-md-3">

                                            <div class="form-group">
                                                <label>Line No </label>@*@Html.ValidationMessageFor(model => model.masterdata[0].OSMLNO)*@
                                                <input type="text" class="OSMLNO form-control" name="OSMLNO" id="OSMLNO" placeholder="Enter No" tabindex="7" />
                                                @*@Html.TextBox("OSMLNO", new { @class = "form-control  OSMLNO", @id = "OSMLNO", @required = "required", tabindex = "50", @placeholder = "---Please Type Line No----" })*@

                                            </div>
                                        </div>
                                        <div class="col-md-2">

                                            <div class="form-group">
                                                <br />
                                                <input type="button" name="search" value="Search" class="btn btn-success btn-xs  " id="search" onclick="GetDetail()" tabindex="8" />
                                            </div>
                                        </div>



                                    </div>

                                    <input type="text" id="pd_index" value="0" style="display:none">

                                    <div style="float:right">
                                    </div>
                                    <div style="clear:both"> </div>
                                </div>

                                <div class="panel-heading navbar-inverse" style="color:white"> Details</div>

                                <table class="table table-striped table-bordered bootstrap-datatable TDETAIL" id="TDETAIL">
                                    <thead>
                                        <tr>

                                            <th>S No</th>
                                            <th>
                                                In Date
                                            </th>
                                            <th>
                                                Container No
                                            </th>
                                            <th>
                                                Size
                                            </th>

                                            <th>
                                                Importer

                                            </th>

                                            <th>Steamer</th>
                                            <th><input type='checkbox' id='CHCK_ALL' name='CHCK_ALL' class='CHCK_ALL' onchange="checkall()" /></th>

                                        </tr>
                                    </thead>

                                    <tbody id="job_list"></tbody>
                                </table>



                                <div class="col-lg-12">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label>Choose Importer  </label>

                                            <input type="text" value="" id="TRANREFNAME" class=" form-control TRANREFNAME" name="TRANREFNAME" data-autocomplete-url="@Url.Action("AutoImporter", "ImporterUpdate")" placeholder="Please Choose Importer" />
                                            <input type="text" value="" id="TRANREFID" class="hide form-control TRANREFID" name="TRANREFID" />
                                        </div>
                                    </div>
                                </div>


                                <div class="col-md-12 box-footer">
                                    <input type="button" name="back" value="Go Back" class="btn btn-primary btn-xs  pull-left" onclick="JavaScript:history.back()" />

                                    <input type="submit" name="submit" value="Update" class="btn btn-success btn-xs  " id="save" tabindex="5010" />

                                </div>

                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {

    <script type="text/javascript">



        $(document).ready(function () {


            add_autocomplete($(".TRANREFNAME"), "TRANREFNAME,TRANREFID");


        });//.......end of bind



        function total() {
            i = 0; //$("#TRANGAMT").val("0");
            // $(".TRANDID").each(function () {
            $(".STFDIDS").each(function () {
                ckb = $(this).is(':checked');

                if (ckb == true) {

                    $(".boolSTFDIDS")[i].value = ckb;
                    //   if ($(".boolSTFDIDS")[i].value == "true") { count++; }


                }
                else {


                    $(".boolSTFDIDS")[i].value = false;

                }

                i++;
            });

        }

        //........get detail row.....................//
        function GetDetail() {
            // alert("SS");

            var igmno = $("#OSMIGMNO").val();
            var gplno = $("#OSMLNO").val();

            if (igmno == "") {
                alert('Please Enter IGM No');
                $("#OSMIGMNO").focus();
                return false;
            }

            if (gplno == "") {
                alert('Please Enter Line No');
                $("#OSMLNO").focus();
                return false;
            }

            url = "/ImporterUpdate/Detail/" + igmno + "~" + gplno + "~";
            // alert(url);


            $.ajax({
                url: url,
                success: function (data) {
                    //alert(data);
                    $("#job_list").html("");
                    $("#job_list").html(data);

                }

            });//---End of Post--------

        }

        function Validate() {
            var flag = true;
            var i = 0;

            var igmno = $("#OSMIGMNO").val();
            var gplno = $("#OSMLNO").val();

            if (igmno == "") {
                alert('Please Enter IGM No');
                $("#OSMIGMNO").focus();
                //return false;
                flag = false;
            }
            else  if (gplno == "") {
                alert('Please Enter Line No');
                $("#OSMLNO").focus();
                //return false;
                flag = false;
            }
            else if (($('#TRANREFID').val() == "" || $('#TRANREFID').val() == "0") && ($('#TRANREFNAME').val() == "")) {
                alert("Please Choose Importer");
                $('#TRANREFNAME').focus();
                flag = false;

            }
            if (flag) {
                var tbl = $("#TDETAIL").find('tbody').length;
                if (tbl > 0) {
                    if ($('input[type=checkbox]:checked').length == 0) {
                        alert("ERROR! Please select at least one checkbox");
                        flag = false;
                        
                    }
                    else {
                        flag = true;
                      
                    }
                }
               
            }
            if (flag) {
                
                var r = confirm("Are you sure to submit this record ?");
                if (r == true) {
                    return true;
                } else {
                  
                    return false;

                }
            } else {
              
                return false;
            }
            
        }

        function checkall() {
            i = 0; j = 0;
            CHCK_ALL = $("#CHCK_ALL").is(':checked');
            var tbl = $("#TDETAIL").find('tbody');


            $(".STFDIDS").each(function () {

                $trcur = tbl.find("tr:eq(" + i + ")");
                if (CHCK_ALL == true) {
                    $trcur.find(".STFDIDS").prop("checked", true);
                    $(".boolSTFDIDS")[i].value = "true"; //alert("i" + i);
                }
                else {
                    // alert("i..."+i);
                    $trcur.find(".STFDIDS").removeAttr("checked", true);
                    $(".boolSTFDIDS")[i].value = "false";
                }

                i++;

            });



        }/*.....*/
    </script>
}

